(function(e){function n(n){for(var r,u,c=n[0],i=n[1],s=n[2],d=0,f=[];d<c.length;d++)u=c[d],o[u]&&f.push(o[u][0]),o[u]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);l&&l(n);while(f.length)f.shift()();return a.push.apply(a,s||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,u=1;u<t.length;u++){var i=t[u];0!==o[i]&&(r=!1)}r&&(a.splice(n--,1),e=c(c.s=t[0]))}return e}var r={},o={app:0},a=[];function u(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-2d0af86f":"4b54918e","chunk-2d0b6a9b":"8779589d","chunk-2d0b9232":"8a7390ae","chunk-2d0c51f7":"1342496e","chunk-2d0d5c8b":"a335c55e","chunk-2d0f1194":"c498adf8","chunk-2d2091fc":"32cca1ab","chunk-2d21b87b":"2719917e","chunk-2d21e308":"9a860c29","chunk-2d225672":"ea3e9b7b","chunk-2d0af879":"ec3568ba"}[e]+".js"}function c(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.e=function(e){var n=[],t=o[e];if(0!==t)if(t)n.push(t[2]);else{var r=new Promise(function(n,r){t=o[e]=[n,r]});n.push(t[2]=r);var a,i=document.createElement("script");i.charset="utf-8",i.timeout=120,c.nc&&i.setAttribute("nonce",c.nc),i.src=u(e),a=function(n){i.onerror=i.onload=null,clearTimeout(s);var t=o[e];if(0!==t){if(t){var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src,u=new Error("Loading chunk "+e+" failed.\n("+r+": "+a+")");u.type=r,u.request=a,t[1](u)}o[e]=void 0}};var s=setTimeout(function(){a({type:"timeout",target:i})},12e4);i.onerror=i.onload=a,document.head.appendChild(i)}return Promise.all(n)},c.m=e,c.c=r,c.d=function(e,n,t){c.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,n){if(1&n&&(e=c(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)c.d(t,r,function(n){return e[n]}.bind(null,r));return t},c.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(n,"a",n),n},c.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},c.p="/vue-router-power-demo/",c.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=n,i=i.slice();for(var d=0;d<i.length;d++)n(i[d]);var l=s;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"0f9a":function(e,n,t){"use strict";t.r(n);t("7f7f");var r=t("a78e"),o=t.n(r),a=t("bc3a"),u=t.n(a),c=u.a.create({}),i=c,s=function(e){return i({url:"/api/login",method:"post",data:e})},d=function(e){return i({url:"/api/getuserinfo",method:"get",params:e})},l=function(e){return i({url:"/api/logout",method:"get",params:e})},f=t("a18c"),p={};p.state={token:o.a.get("token"),name:"",role:""},p.mutations={set_token:function(e,n){e.token=n},set_name:function(e,n){e.name=n},set_role:function(e,n){e.role=n}},p.actions={login:function(e,n){var t=e.commit,r=n.username,a=n.password;return new Promise(function(e,n){s({username:r.trim(),password:a}).then(function(n){var r=n.data;if(window.console.log(r),r.code){var a=r.data;t("set_token",a.token),o.a.set("token",a.token)}e(r)}).catch(function(e){n(e)})})},getUserInfo:function(e){var n=e.commit,t=e.state;return new Promise(function(e,r){d({token:t.token}).then(function(t){var o=t.data,a=o.data;window.console.log(o),o.code||r(o),n("set_name",a.name),n("set_role",a.role),e(o)}).catch(function(e){r(e)})})},logout:function(e){var n=e.commit,t=e.state;return new Promise(function(e,r){l({token:t.token}).then(function(t){n("set_token",""),n("set_name",""),n("set_role",""),Object(f["d"])(),o.a.set("token",""),e(t.data)}).catch(function(e){r(e)})})}};n["default"]=p},"23ad":function(e,n,t){"use strict";t.r(n);var r=t("96eb"),o=t.n(r);n["default"]=function(e){return o.a.mock(function(){var n=e.username,t={code:1,msg:"登录成功"};return"user"===n?(t.data={},t.data.token="hsghd23h2g3j2"):"admin"===n?(t.data={},t.data.token="hasjdah2h1jjh"):"superadmin"===n?(t.data={},t.data.token="sdah4kh3k4jh3"):(t.code=0,t.msg="用户密码错误"),t})}},2902:function(e,n,t){"use strict";t.r(n);var r=t("c1f7"),o=[{path:"/login",name:"login",hidden:!0,component:function(){return t.e("chunk-2d0f1194").then(t.bind(null,"9ed6"))}},{path:"/404",name:"404",hidden:!0,component:function(){return t.e("chunk-2d0b6a9b").then(t.bind(null,"1db4"))}},{path:"/",name:"home",hidden:!0,redirect:"/document"},{path:"/document",component:r["a"],children:[{path:"",name:"document",component:function(){return t.e("chunk-2d2091fc").then(t.bind(null,"a85d"))},meta:{icon:"s-order",title:"参考文档"}}]}];n["default"]=o},"31c2":function(e,n,t){"use strict";t.r(n),t.d(n,"filterAsyncRoutes",function(){return u});var r=t("cebc"),o=(t("ac6a"),t("6762"),t("2fdb"),t("a18c")),a=function(e,n){return!e.meta||!e.meta.roles||!!e.meta.roles.includes(n)},u=function e(n,t){var o=[];return n.forEach(function(n){var u=Object(r["a"])({},n);if(a(u,t)){u.children&&(u.children=e(u.children,t));var c=u.children&&u.children.length>0;u.children&&!c||o.push(u)}}),o},c={state:{routes:[],addRoutes:[]}};c.mutations={set_route:function(e,n){e.addRoutes=n,e.routes=o["b"].concat(n)}},c.actions={generateRoutes:function(e){var n=e.commit,t=e.rootGetters;return new Promise(function(e,r){var a;a=u(o["a"],t.role),n("set_route",a),window.console.log(a),e(a)})}},n["default"]=c},4744:function(e,n,t){var r={"./getuserinfo.js":"79c7","./login.js":"23ad","./logout.js":"9fc0"};function o(e){var n=a(e);return t(n)}function a(e){var n=r[e];if(!(n+1)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="4744"},"56d7":function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d");var r=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},a=[],u=t("2877"),c={},i=Object(u["a"])(c,o,a,!1,null,null,null),s=i.exports,d=t("a18c"),l=(t("a481"),t("ac6a"),t("2f62")),f=(t("7f7f"),{token:function(e){return e.user.token},role:function(e){return e.user.role},name:function(e){return e.user.name},permission_routes:function(e){return e.permission.routes}}),p=f;r["default"].use(l["a"]);var h=t("d307"),m=h.keys().reduce(function(e,n){var t=n.replace(/^\.\/(.*)\.\w+$/,"$1"),r=h(n);return e[t]=r.default,e},{}),g=new l["a"].Store({modules:m,getters:p}),b=g,v=t("5c96"),k=t.n(v),w=(t("0fae"),t("8e1f"),t("3b2b"),t("386d"),t("96eb")),j=t.n(w),y=t("b383"),_=t.n(y),O=function(e){var n="http://"+location.host+"/",t=new URL(e,n),r=t.pathname,o=_.a.parse(t.search.slice(1));return{api:r,params:o}},x=function(e,n){var t=e,r=JSON.parse(n);return{api:t,params:r}};j.a.mock(RegExp("/api/.*"),function(e){var n="GET"===e.type?O(e.url):x(e.url,e.body),r=t("4744"),o=r.keys().reduce(function(e,n){var t=n.replace(/^\.\/(.*)\.\w+$/,"$1");return e[t]=r(n).default,e},{}),a=n.api.replace(/^\/api\/(.*)$/,"$1"),u=o[a];return u?u(n.params):{code:0,msg:"there is no api for "+a}});var E=t("cebc"),P=(t("96cf"),t("3b8d")),R=["/login"];d["c"].beforeEach(function(){var e=Object(P["a"])(regeneratorRuntime.mark(function e(n,t,r){var o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(window.console.log("★ ★ ★ route begin judging..."),!b.getters.token){e.next=26;break}if(window.console.log("has token, goto path is "+n.path),"/login"!==n.path){e.next=8;break}window.console.log("jumper home /"),r("/"),e.next=24;break;case 8:if(0!==b.getters.role.length){e.next=22;break}return window.console.log("role is empty, and get user info..."),e.next=12,b.dispatch("getUserInfo");case 12:return window.console.log("get permission routes map..."),e.next=15,b.dispatch("generateRoutes");case 15:o=e.sent,window.console.log("add routes..."),d["c"].addRoutes(o),window.console.log("refresh pages..."),r(Object(E["a"])({},n,{replace:!0})),e.next=24;break;case 22:window.console.log("role is "+b.getters.role+" , end ▲ ▲ ▲"),r();case 24:e.next=28;break;case 26:window.console.log("no token, goto path is "+n.path),R.indexOf(n.path)>-1?(window.console.log("page is in white list, end ▲ ▲ ▲"),r()):(window.console.log("page not in white list, goto /login"),r({name:"login",query:{redirect:n.path}}));case 28:case"end":return e.stop()}},e)}));return function(n,t,r){return e.apply(this,arguments)}}()),r["default"].use(k.a),r["default"].config.productionTip=!1,new r["default"]({router:d["c"],store:b,render:function(e){return e(s)}}).$mount("#app")},"79c7":function(e,n,t){"use strict";t.r(n);var r=t("96eb"),o=t.n(r);n["default"]=function(e){return o.a.mock(function(){return"hsghd23h2g3j2"===e.token?{code:1,msg:"success",data:{name:"user",role:"user"}}:"hasjdah2h1jjh"===e.token?{code:1,msg:"success",data:{name:"admin",role:"admin"}}:"sdah4kh3k4jh3"===e.token?{code:1,msg:"success",data:{name:"superadmin",role:"superadmin"}}:{code:0,msg:"token无效"}})}},"8e1f":function(e,n,t){},"9fc0":function(e,n,t){"use strict";t.r(n);var r=t("96eb"),o=t.n(r);n["default"]=function(){return o.a.mock(function(){return{code:1,msg:""}})}},a18c:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return u}),t.d(n,"d",function(){return s});var r=t("2b0e"),o=t("8c4f");r["default"].use(o["a"]);var a=t("2902").default,u=t("f8fb").default,c=function(){return new o["a"]({mode:"history",routes:a})},i=c(),s=function(){var e=c();i.matcher=e.matcher};n["c"]=i},c1f7:function(e,n,t){"use strict";var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("el-container",[t("cl-header"),t("el-container",[t("cl-side-bar"),t("keep-alive",[t("router-view")],1)],1),t("el-footer",{attrs:{height:"0"}})],1)},o=[],a={components:{"cl-header":function(){return t.e("chunk-2d0d5c8b").then(t.bind(null,"7084"))},"cl-side-bar":function(){return t.e("chunk-2d21e308").then(t.bind(null,"d501"))}}},u=a,c=t("2877"),i=Object(c["a"])(u,r,o,!1,null,null,null);n["a"]=i.exports},d307:function(e,n,t){var r={"./permission.js":"31c2","./user.js":"0f9a"};function o(e){var n=a(e);return t(n)}function a(e){var n=r[e];if(!(n+1)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="d307"},f8fb:function(e,n,t){"use strict";t.r(n);var r=t("c1f7"),o=[{path:"/permission",redirect:"/permission/user",hidden:!0},{path:"/permission",component:r["a"],children:[{path:"page",name:"permission-page",component:function(){return t.e("chunk-2d0b9232").then(t.bind(null,"3252"))},meta:{icon:"s-tools",title:"管理系统",roles:["admin","superadmin"]}}]},{path:"/permission",component:r["a"],children:[{path:"user",name:"permission-user",component:function(){return t.e("chunk-2d0af86f").then(t.bind(null,"0f69"))},meta:{icon:"menu",title:"权限浏览",roles:["admin","superadmin","user"]}}]},{path:"/permission",component:r["a"],children:[{path:"super",name:"permission-super",component:function(){return t.e("chunk-2d21b87b").then(t.bind(null,"bfbc"))},meta:{icon:"user-solid",title:"超级管理",roles:["superadmin"]}}]},{path:"/page1",component:r["a"],children:[{path:"",name:"page1",meta:{icon:"location",title:"page1"},component:function(){return t.e("chunk-2d225672").then(t.bind(null,"e3f4"))}}]},{path:"/page2",component:r["a"],children:[{path:"",name:"page2",meta:{icon:"picture",title:"page2"},component:function(){return t.e("chunk-2d0c51f7").then(t.bind(null,"3e6e"))}}]},{path:"*",hidden:!0,redirect:"/404"}];n["default"]=o}});
//# sourceMappingURL=app.12da5f35.js.map